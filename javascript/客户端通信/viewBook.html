<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>viewBook</title>
</head>
<body>
<script type="text/javascript">

	var choosebook=function(){
		
		var targetWin=window.open("http://localhost:8080/sublime-workspace/javascript/客户端通信/chooseBook.html",'_blank','width=510,height=300');

		targetWin.onload=function(){
			var data=[
				{
					name:'疯狂Java讲义',
					price:109,
					author:'李刚'
				},
				{
					name:'疯狂讲义',
					price:10,
					author:'李刚'
				},
				{
					name:'Java讲义',
					price:19,
					author:'李刚'
				}
			];
			targetWin.postMessage(data,"http://localhost:8080");
		}
	}
	window.onmessage=function(ev){
		if(ev.origin!="http://localhost:8080"){
			return;
		}
		var show=document.getElementById('result');
		show.innerHTML=("你选择的图书为：<br />"+
			ev.data.name+"<br />"+
			ev.data.price+"<br />"+
			ev.data.author+"<br />");
	}
</script>

<a href="#" onclick="choosebook()">选择图书</a>
<div id="result"></div>

<!-- <script type="text/javascript">
	var chooseBook = function()
	{
		// 打开一个新窗口
		var targetWin = window.open('http://localhost:8080/sublime-workspace/javascript/客户端通信/chooseBook.html'
			,'_blank','width=510,height=300');
		// 等该窗口装载完成时，向该窗口发送消息
		targetWin.onload = function ()
		{ 
			var data = [
				{
					name : '疯狂Java讲义',
					price : 109,
					author : 'yeeku'
				},
				{
					name : '疯狂Android讲义',
					price : 108,
					author : 'yeeku'
				},
				{
					name : '轻量级Java EE企业应用实战',
					price : 108,
					author : 'yeeku'
				}
			];
			// 向http://localhost:8888/target发送消息
			targetWin.postMessage(data
				, "http://localhost:8080");    // ①
		}
	}
	// 通过onmessage监听器监听其他窗口发送回来的消息
	window.onmessage = function(ev) 
	{
		// 忽略来自其他域名的跨文档消息（只接受http://localhost:8888的消息）
		if (ev.origin != "http://localhost:8080") 
		{
			return;
		}
		var show = document.getElementById("result");
		// 显示消息
		show.innerHTML = ("您选择的图书为：<br/>"
			+ "书名：" + ev.data.name + "<br/>"
			+ "价格：" + ev.data.price + "<br/>"
			+ "作者：" + ev.data.author + "<br/>");
	};
	</script>

<a href="#" onclick="chooseBook();">选择图书</a>
<div id="result"></div>
 -->

</body>
</html>